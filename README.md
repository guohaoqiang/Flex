# Flex
SpMM: Sparse-dense matrix multiplication

## Complile
- Run `./compile.sh`


## Run
- Run `./run.sh`


## Example Data:
|  ASpT  |        Size       | #Non-zeros |
|:------:|:-----------------:|:----------:|
| Pubmed |   19717 X 19717   |   108365   |
| Flickr |   89250 X 89250   |   989006   |
| Reddit |  232965 X 232965  |  23446803  |
|   PPI  |   14755 X 14755   |   458973   |
| Amazon | 1569960 X 1569960 |  264339468 |
|  Yelp  |  716847 X 716847  |  13954819  |



## Vertex Ordering
The code for DEG,RCM and Gorder was taken from [here](https://github.com/lecfab/rescience-gorder)

## [ASpT](http://gitlab.hpcrl.cse.ohio-state.edu/chong/ppopp19_ae) results
>**Note**  
>tPre: time of preprocessing.  
>tElap: time of spmm.  
>GFlops: 2\*FMAs/tElap.  


| ASpT(k=128) |    3090    |        |          |    4090    |         |          |    H100    |         |          |
|:-----------:|:----------:|:------:|:--------:|:----------:|:-------:|:--------:|:----------:|:-------:|:--------:|
|             | tPre/tElap | GFlops | Errs (%) | tPre/tElap |  GFlops | Errs (%) | tPre/tElap |  GFlops | Errs (%) |
|    Pubmed   |    92.5    | 311.39 |   0.005  |    18.7    |  639.8  |   0.005  |    90.13   |  275.83 |   0.005  |
|    Flickr   |    2.84    |  499.5 |   0.001  |     4.5    |  1308.2 |  0.0011  |    6.18    | 1037.78 |  0.0011  |
|    Reddit   |    1.149   | 259.35 |  97.071  |    3.97    |  1100.8 |  97.077  |    2.58    | 1237.25 |  99.028  |
|     PPI     |    7.77    | 671.01 |  0.0067  |    8.17    |  1182.9 |  0.0067  |    9.53    |  811.62 |  0.0067  |
|    Amazon   |   21.415   | 284.49 |   90.25  |   329.07   | 1150.06 |   90.25  |    522.4   | 1314.59 |   98.34  |
|     Yelp    |  0.212705  | 470.03 |  0.00014 |     0.3    | 1135.66 |  0.0001  |    0.44    | 1451.86 |  0.0001  |


| ASpT(k=32) |    3090    |         |          |    4090    |         |          |    H100    |         |          |
|:----------:|:----------:|:-------:|:--------:|:----------:|:-------:|:--------:|:----------:|:-------:|:--------:|
|            | tPre/tElap |  GFlops | Errs (%) | tPre/tElap |  GFlops | Errs (%) | tPre/tElap |  GFlops | Errs (%) |
|   Pubmed   |   109.75   |  105.67 |   0.005  |   177.32   |  167.88 |   0.005  |    84.9    |   70.8  |   0.005  |
|   Flickr   |    7.83    |  391.22 |   0.001  |    12.58   |  977.28 |  0.0011  |    11.15   | 485.998 |  0.0011  |
|   Reddit   |    0.514   |  557.83 |   0.001  |    1.28    | 1982.98 |  0.00098 |    1.28    |  1819.7 |  0.00098 |
|     PPI    |    12.67   |  311.59 |  0.0067  |   13.625   |  504.92 |  0.0067  |    9.63    |  324.82 |  0.0067  |
|   Amazon   |   472.63   | 316.668 |   98.47  |      *     |    *    |     *    |   1427.16  |  1056.2 |   98.34  |
|    Yelp    |    0.762   |  479.74 |  0.0001  |    1.318   | 1256.62 |  0.00014 |    1.232   |  1044.4 |  0.0001  |


